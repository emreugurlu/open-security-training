<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>GRC Engineering: Cybersecurity & Privacy Training</title>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }

    :root {
      --primary-purple:#7B2CBF; --light-purple:#E0B0FF; --dark-purple:#4A1A6B;
      --primary-teal:#06A77D; --light-teal:#B2F5E8; --dark-teal:#045F4A;
      --off-black:#17191E; --white:#FFFFFF; --success-green:#4CAF50;
      --warning-amber:#FF9800; --error-red:#F44336; --neutral-gray:#9E9E9E;
      --light-gray:#F5F5F5; --medium-gray:#E0E0E0;
    }
    
    body { 
      font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
      display: flex;
      height: 100vh;
      overflow: hidden;
    }
    
    /* Sidebar Navigation */
    .sidebar {
      width: 280px;
      background: white;
      box-shadow: 2px 0 10px rgba(0,0,0,0.1);
      display: flex;
      flex-direction: column;
      z-index: 100;
      position: relative;
      transition: margin-left 0.3s ease;
    }
    
    .sidebar.collapsed {
      margin-left: -280px; /* Fully hide the sidebar */
    }
    
    .sidebar-toggle {
      position: fixed; /* Changed to fixed so it stays visible */
      left: 280px; /* Position at edge of sidebar */
      top: 20px;
      width: 30px;
      height: 40px;
      background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-teal) 100%);
      color: white;
      border: none;
      border-radius: 0 8px 8px 0;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      z-index: 101;
      transition: all 0.3s ease;
    }
    
    .sidebar.collapsed ~ .sidebar-toggle,
    .sidebar-toggle.collapsed {
      left: 0; /* Move button to left edge when collapsed */
    }
    
    .sidebar-toggle:hover {
      background: var(--dark-purple);
    }
    
    .sidebar-header {
      background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-teal) 100%);
      color: white;
      padding: 24px;
      text-align: center;
    }
    
    .sidebar-logo {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
      margin-bottom: 16px;
      cursor: pointer;
    }
    
    .grc-owl {
      width: 48px;
      height: 48px;
      background: transparent;
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 32px;
    }
    
    .sidebar-title {
      font-size: 18px;
      font-weight: 700;
    }
    
    .home-button {
      background: rgba(255,255,255,0.2);
      color: white;
      border: 1px solid rgba(255,255,255,0.3);
      padding: 8px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 12px;
      transition: all 0.3s ease;
    }
    
    .home-button:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .module-list {
      flex: 1;
      overflow-y: auto;
      padding: 20px;
    }
    
    .module-item {
      background: white;
      border: 2px solid var(--medium-gray);
      border-radius: 12px;
      padding: 16px;
      margin-bottom: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }
    
    .module-item:hover {
      border-color: var(--primary-purple);
      box-shadow: 0 4px 12px rgba(29,99,237,0.15);
    }
    
    .module-item.active {
      border-color: var(--primary-purple);
      background: var(--light-purple);
    }
    
    .module-item.completed {
      border-color: var(--success-green);
    }
    
    .module-title-wrapper {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 8px;
    }
    
    .module-title-content {
      display: flex;
      align-items: center;
      gap: 12px;
      flex: 1;
    }
    
    .module-icon {
      font-size: 24px;
      flex-shrink: 0;
    }
    
    .module-name {
      font-weight: 600;
      color: var(--dark-purple);
      flex: 1;
    }
    
    .module-status {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: var(--medium-gray);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      min-width: 24px;
      min-height: 24px;
    }
    
    .module-status.in-progress {
      background: var(--warning-amber);
      color: white;
    }
    
    .module-status.in-progress::after {
      content: '\2022';
      font-size: 16px;
    }
    
    .module-status.completed {
      background: var(--success-green);
      color: white;
    }
    
    .module-status.completed::after {
      content: '✓';
      font-weight: bold;
    }
    
    .module-progress {
      margin-top: 8px;
    }
    
    .progress-bar {
      height: 4px;
      background: var(--medium-gray);
      border-radius: 2px;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-teal) 100%);
      transition: width 0.5s ease;
    }
    
    .progress-text {
      font-size: 12px;
      color: #666;
      margin-top: 4px;
    }
    
    /* Main Content Area */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      background: #f5f5f5;
      position: relative;
    }
    
    .content-frame {
      width: 100%;
      height: 100%;
      border: none;
      background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-teal) 100%);
    }
    
    .loading-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    
    .loading-overlay.show {
      display: flex;
    }
    
    .loading-spinner {
      width: 50px;
      height: 50px;
      border: 4px solid rgba(255, 255, 255, 0.3);
      border-top: 4px solid white;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* Home Screen */
    .home-screen {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      height: 100%;
      padding: 40px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      text-align: center;
      overflow-y: auto;
    }
    
    .home-title {
      font-size: 48px;
      font-weight: 700;
      margin-top: 20px;
      margin-bottom: 24px;
      text-shadow: 0 2px 4px rgba(0,0,0,0.2);
    }
    
    .home-subtitle {
      font-size: 24px;
      margin-bottom: 32px;
      opacity: 0.95;
    }
    
    .module-cards {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 20px;
      max-width: 1000px;
      width: 100%;
      margin-bottom: 40px;
    }
    
    .module-card {
      background: white;
      color: var(--dark-purple);
      padding: 24px;
      border-radius: 16px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 4px 20px rgba(0,0,0,0.1);
      min-height: 180px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
    
    .module-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 8px 30px rgba(0,0,0,0.2);
    }
    
    .module-card-icon {
      font-size: 48px;
      margin-bottom: 16px;
    }
    
    .module-card-title {
      font-size: 20px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    
    .module-card-description {
      font-size: 14px;
      color: #666;
    }
    
    /* Module Transition Screen */
    .transition-screen {
      display: none;
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%);
      color: white;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      z-index: 1000;
    }
    
    .transition-screen.show {
      display: flex;
    }
    
    .transition-content {
      text-align: center;
      animation: fadeInUp 0.8s ease;
    }
    
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-20px); }
    }
    
    .transition-icon {
      font-size: 80px;
      margin-bottom: 24px;
    }
    
    .transition-title {
      font-size: 36px;
      font-weight: 700;
      margin-bottom: 16px;
    }
    
    .transition-message {
      font-size: 20px;
      opacity: 0.9;
      margin-bottom: 32px;
    }
    
    .transition-button {
      background: white;
      color: var(--primary-purple);
      padding: 16px 32px;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin: 8px;
    }
    
    .transition-button:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 20px rgba(255,255,255,0.3);
    }
    
    .transition-button.secondary {
      background: transparent;
      color: white;
      border: 2px solid white;
    }
    
    .transition-button.secondary:hover {
      background: rgba(255,255,255,0.1);
    }
    
    /* Policy Attestation Styles */
    .policy-attestation {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      padding: 20px;
      overflow: hidden;
      z-index: 2000;
    }
    
    .attestation-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      max-width: 800px;
      width: 100%;
      height: fit-content;
      max-height: 95vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .grc-logo-header {
      background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-teal) 100%);
      color: white;
      padding: 25px;
      text-align: center;
      flex-shrink: 0;
    }
    
    .grc-logo-header h1 {
      margin: 12px 0 0 0;
      font-size: 28px;
      font-weight: 700;
    }
    
    .attestation-content {
      padding: 25px 35px;
      flex: 1;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
    }
    
    .attestation-content h2 {
      color: var(--dark-purple);
      margin: 0 0 16px 0;
      font-size: 24px;
    }
    
    .policy-info {
      margin-bottom: 20px;
      flex: 1;
    }
    
    .policy-info p {
      color: #666;
      font-size: 15px;
      line-height: 1.5;
      margin-bottom: 16px;
    }
    
    .policy-link-box {
      background: #f8f9fa;
      border: 2px solid var(--light-purple);
      border-radius: 12px;
      padding: 18px;
      margin: 16px 0;
    }
    
    .policy-link-box h3 {
      color: var(--dark-purple);
      margin: 0 0 12px 0;
      font-size: 18px;
    }
    
    .policy-link {
      display: flex;
      align-items: center;
      gap: 12px;
      background: linear-gradient(135deg, var(--primary-purple) 0%, var(--primary-teal) 100%);
      color: white;
      text-decoration: none;
      padding: 12px 20px;
      border-radius: 8px;
      margin: 14px 0;
      transition: all 0.3s ease;
      font-size: 16px;
      font-weight: 600;
    }
    
    .policy-link:hover {
      background: var(--dark-purple);
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(29,99,237,0.3);
    }
    
    .link-icon {
      font-size: 24px;
    }
    
    .link-text {
      flex: 1;
    }
    
    .link-arrow {
      font-size: 20px;
      transition: transform 0.3s ease;
    }
    
    .policy-link:hover .link-arrow {
      transform: translateX(5px);
    }
    
    .policy-categories {
      margin-top: 16px;
    }
    
    .policy-categories p {
      margin: 12px 0 8px 0;
      font-weight: 600;
      color: var(--dark-purple);
      font-size: 14px;
    }
    
    .policy-categories ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    
    .policy-categories li {
      padding: 5px 0;
      color: #666;
      font-size: 14px;
    }
    
    .attestation-form {
      background: #f8f8f8;
      border-top: 2px solid #e0e0e0;
      padding: 20px 35px;
      flex-shrink: 0;
    }
    
    .checkbox-container {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      margin-bottom: 15px;
    }
    
    .checkbox-container input[type="checkbox"] {
      margin-top: 2px;
      width: 18px;
      height: 18px;
      cursor: pointer;
      flex-shrink: 0;
    }
    
    .checkbox-container label {
      flex: 1;
      color: #333;
      font-size: 15px;
      line-height: 1.4;
      cursor: pointer;
    }
    
    .attest-info {
      background: #fff3cd;
      border-left: 4px solid #ffc107;
      padding: 10px 14px;
      margin: 15px 0;
      border-radius: 4px;
    }
    
    .attest-info p {
      margin: 0;
      color: #856404;
      font-size: 13px;
      line-height: 1.4;
    }
    
    .attest-button {
      width: 100%;
      padding: 14px 28px;
      background: var(--success-green);
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 17px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-top: 15px;
    }
    
    .attest-button:not(:disabled):hover {
      background: #45a049;
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(76,175,80,0.3);
    }
    
    .attest-button:disabled {
      background: #ccc;
      cursor: not-allowed;
      opacity: 0.6;
    }

    /* Reset Confirmation Modal */
    .reset-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 3000;
      transition: background 0.3s ease;
    }

    .reset-modal.show {
      display: flex;
    }

    .reset-modal.animate-in {
      background: rgba(0, 0, 0, 0.7);
    }

    .reset-modal-content {
      background: white;
      border-radius: 16px;
      padding: 40px;
      max-width: 500px;
      width: 90%;
      text-align: center;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      transform: scale(0.7);
      opacity: 0;
      transition: all 0.3s ease;
    }

    .reset-modal-content.animate-in {
      transform: scale(1);
      opacity: 1;
    }

    .reset-modal-icon {
      font-size: 64px;
      margin-bottom: 20px;
    }

    .reset-modal-title {
      color: var(--dark-purple);
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 16px;
    }

    .reset-modal-message {
      color: #666;
      font-size: 16px;
      line-height: 1.5;
      margin-bottom: 32px;
    }

    .reset-modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: center;
    }

    .reset-modal-button {
      padding: 12px 32px;
      border-radius: 8px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
    }

    .reset-modal-button.cancel {
      background: var(--medium-gray);
      color: #333;
    }

    .reset-modal-button.cancel:hover {
      background: #d0d0d0;
    }

    .reset-modal-button.confirm {
      background: linear-gradient(135deg, #f44336 0%, #c62828 100%);
      color: white;
    }

    .reset-modal-button.confirm:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(244, 67, 54, 0.3);
    }

    /* Responsive */
    @media (max-width: 768px) {
      .sidebar {
        width: 240px;
      }
      
      .module-cards {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
  <div class="sidebar" id="sidebar">
    <button class="sidebar-toggle" onclick="toggleSidebar()" title="Toggle Sidebar">☰</button>
    <div class="sidebar-header">
      <div class="sidebar-logo" onclick="goHome()">
        <div class="grc-owl">👾</div>
        <div class="sidebar-title">Cybersecurity & Privacy</div>
      </div>
      <button class="home-button" onclick="goHome()" style="width: 100%;">🏠 Return to Home</button>
      <button class="home-button" onclick="showResetModal()" style="background: linear-gradient(135deg, #f44336 0%, #c62828 100%); width: 100%;">🔄 Reset Training</button>
    </div>
    
    <div class="module-list">
      <div class="module-item" id="module-phishing" onclick="loadModule('phishing')">
        <div class="module-title-wrapper">
          <div class="module-title-content">
            <span class="module-icon">📧</span>
            <span class="module-name">Phishing, Smishing & Vishing</span>
          </div>
          <div class="module-status" id="status-phishing"></div>
        </div>
        <div class="module-progress">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-phishing" style="width: 0%"></div>
          </div>
          <div class="progress-text" id="progress-text-phishing">0/8 slides completed</div>
        </div>
      </div>
      
      <div class="module-item" id="module-ceo" onclick="loadModule('ceo')">
        <div class="module-title-wrapper">
          <div class="module-title-content">
            <span class="module-icon">🏢</span>
            <span class="module-name">CEO & Executive Fraud</span>
          </div>
          <div class="module-status" id="status-ceo"></div>
        </div>
        <div class="module-progress">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-ceo" style="width: 0%"></div>
          </div>
          <div class="progress-text" id="progress-text-ceo">0/6 slides completed</div>
        </div>
      </div>
      
      <div class="module-item" id="module-watering" onclick="loadModule('watering')">
        <div class="module-title-wrapper">
          <div class="module-title-content">
            <span class="module-icon">🦁</span>
            <span class="module-name">Watering Hole Attacks</span>
          </div>
          <div class="module-status" id="status-watering"></div>
        </div>
        <div class="module-progress">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-watering" style="width: 0%"></div>
          </div>
          <div class="progress-text" id="progress-text-watering">0/8 slides completed</div>
        </div>
      </div>
      
      <div class="module-item" id="module-general" onclick="loadModule('general')">
        <div class="module-title-wrapper">
          <div class="module-title-content">
            <span class="module-icon">🛡️</span>
            <span class="module-name">General Cybersecurity Awareness</span>
          </div>
          <div class="module-status" id="status-general"></div>
        </div>
        <div class="module-progress">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-general" style="width: 0%"></div>
          </div>
          <div class="progress-text" id="progress-text-general">0/10 slides completed</div>
        </div>
      </div>
      
      <div class="module-item" id="module-privacy" onclick="loadModule('privacy')">
        <div class="module-title-wrapper">
          <div class="module-title-content">
            <span class="module-icon">🔐</span>
            <span class="module-name">Privacy Awareness Training</span>
          </div>
          <div class="module-status" id="status-privacy"></div>
        </div>
        <div class="module-progress">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-privacy" style="width: 0%"></div>
          </div>
          <div class="progress-text" id="progress-text-privacy">0/8 slides completed</div>
        </div>
      </div>
      
      <div class="module-item" id="module-secure-coding" onclick="loadModule('secure-coding')">
        <div class="module-title-wrapper">
          <div class="module-title-content">
            <span class="module-icon">💻</span>
            <span class="module-name">Secure Coding (OWASP)</span>
          </div>
          <div class="module-status" id="status-secure-coding"></div>
        </div>
        <div class="module-progress">
          <div class="progress-bar">
            <div class="progress-fill" id="progress-secure-coding" style="width: 0%"></div>
          </div>
          <div class="progress-text" id="progress-text-secure-coding">0/6 slides completed</div>
        </div>
      </div>
    </div>
  </div>
  
  <div class="main-content">
    <!-- Policy Attestation Screen -->
    <div class="policy-attestation" id="policyAttestation">
      <div class="attestation-container">
        <div class="grc-logo-header">
          <span style="font-size: 48px;">👾</span>
          <h1>GRC Engineering Security & Privacy Training</h1>
        </div>
        
        <div class="attestation-content">
          <h2>📋 Policy Acknowledgment Required</h2>

          <div class="policy-info">
            <p>Before beginning your cybersecurity and privacy training, please review and acknowledge your organization's security policies and procedures.</p>

            <div class="policy-link-box">
              <h3>📚 Organization Policies & Procedures</h3>
              <p>All security and privacy policies should be maintained in your organization's central repository.</p>

              <a href="#"
                 target="_blank"
                 class="policy-link"
                 onclick="alert('Configure this link to point to your organization\'s policy repository'); return false;">
                <span class="link-icon">🔗</span>
                <span class="link-text">View Organization Policies & Procedures</span>
                <span class="link-arrow">→</span>
              </a>
              
              <div class="policy-categories">
                <p><strong>Key policies include:</strong></p>
                <ul>
                  <li>🔒 Information Security Policy</li>
                  <li>🔐 Data Privacy & Protection Policy</li>
                  <li>💻 Acceptable Use Policy</li>
                  <li>🚨 Incident Response Procedures</li>
                  <li>📱 Remote Work Security Guidelines</li>
                </ul>
              </div>
            </div>
          </div>
          
          <div class="attestation-form">
            <div class="checkbox-container">
              <input type="checkbox" id="policyCheckbox" onchange="toggleAttestButton()">
              <label for="policyCheckbox">
                I acknowledge that I have access to my organization's security policies and procedures,
                and I understand my responsibility to comply with them.
              </label>
            </div>

            <div class="attest-info">
              <p><em>By proceeding, you confirm that you know where to find your organization's policies
              and will refer to them as needed during your daily work.</em></p>
            </div>
            
            <button class="attest-button" id="attestButton" disabled onclick="completeAttestation()">
              ☑️ Check the box above to continue →
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Home Screen -->
    <div class="home-screen" id="homeScreen" style="display: none;">
      <h1 class="home-title">🛡️ Cybersecurity & Privacy Training</h1>
      <p class="home-subtitle">Protect your organization from security threats and maintain data privacy</p>
      
      <!-- Completion Status Banner (shows when all modules complete) -->
      <div id="completionBanner" style="display: none; background: linear-gradient(135deg, var(--success-green), #2E7D32); border-radius: 12px; padding: 20px; margin: 10px auto 20px auto; max-width: 800px; text-align: center; box-shadow: 0 4px 20px rgba(76,175,80,0.3);">
        <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
          <span style="font-size: 32px;">🏆</span>
          <h3 style="margin: 0; color: white; font-size: 22px;">All Modules Complete!</h3>
        </div>
        <p style="margin: 10px 0 15px 0; color: rgba(255,255,255,0.95); font-size: 16px;">
          Congratulations! You've successfully completed all training modules.
        </p>
        <div style="display: flex; gap: 15px; justify-content: center; flex-wrap: wrap;">
          <button onclick="showFeedbackForm()" style="background: white; color: var(--primary-purple); border: none; padding: 10px 20px; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer;">Provide Feedback</button>
          <button onclick="exitTraining()" style="background: white; color: #333; border: none; padding: 10px 20px; border-radius: 6px; font-size: 14px; font-weight: 600; cursor: pointer;">Complete and Exit Training</button>
        </div>
      </div>
      
      <div style="margin: 20px auto; max-width: 800px;">
        <div style="background: rgba(255,255,255,0.15); border-radius: 12px; backdrop-filter: blur(10px); overflow: hidden;">
          <button onclick="toggleInstructions()" style="width: 100%; background: rgba(255,255,255,0.1); border: none; padding: 16px; display: flex; align-items: center; justify-content: space-between; cursor: pointer; transition: background 0.3s ease;">
            <div style="display: flex; align-items: center; gap: 12px;">
              <span style="font-size: 24px;">💡</span>
              <h3 style="margin: 0; color: white; font-size: 18px;">Training Instructions</h3>
            </div>
            <span id="instructionArrow" style="color: white; font-size: 18px; transition: transform 0.3s ease;">▼</span>
          </button>
          <div id="instructionsContent" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease;">
            <div style="padding: 16px; border-top: 1px solid rgba(255,255,255,0.1);">
              <p style="margin: 0; color: rgba(255,255,255,0.95); font-size: 14px; line-height: 1.5;">
                <strong>Feel free to click on any element within this training!</strong> There are no wrong answers – the training is designed to guide you to the correct solutions. Explore the modules freely and learn by interacting. Every choice you make helps reinforce important security concepts.
              </p>
            </div>
          </div>
        </div>
      </div>
      
      <div class="module-cards">
        <div class="module-card" onclick="loadModule('phishing')">
          <div class="module-card-icon">📧</div>
          <div class="module-card-title">Phishing, Smishing & Vishing</div>
          <div class="module-card-description">Learn to identify and defend against attacks via email, SMS, and voice calls</div>
        </div>
        
        <div class="module-card" onclick="loadModule('ceo')">
          <div class="module-card-icon">🏢</div>
          <div class="module-card-title">CEO & Executive Fraud</div>
          <div class="module-card-description">Recognize and stop business email compromise and executive impersonation</div>
        </div>
        
        <div class="module-card" onclick="loadModule('watering')">
          <div class="module-card-icon">🦁</div>
          <div class="module-card-title">Watering Hole Attacks</div>
          <div class="module-card-description">Detect when trusted websites have been compromised to target your organization</div>
        </div>
        
        <div class="module-card" onclick="loadModule('general')">
          <div class="module-card-icon">🛡️</div>
          <div class="module-card-title">General Cybersecurity Awareness</div>
          <div class="module-card-description">Master essential security practices including ransomware defense, device security, and password management</div>
        </div>
        
        <div class="module-card" onclick="loadModule('privacy')">
          <div class="module-card-icon">🔐</div>
          <div class="module-card-title">Privacy Awareness Training</div>
          <div class="module-card-description">Master PII protection, data handling, and GDPR/CCPA compliance requirements</div>
        </div>
        
        <div class="module-card" onclick="loadModule('secure-coding')">
          <div class="module-card-icon">💻</div>
          <div class="module-card-title">Secure Coding (OWASP)</div>
          <div class="module-card-description">Learn to prevent OWASP Top 10 vulnerabilities with hands-on coding simulations</div>
        </div>
      </div>
    </div>
    
    <!-- Module Transition Screen -->
    <div class="transition-screen" id="transitionScreen">
      <div class="transition-content">
        <div class="transition-icon" id="transitionIcon">🎉</div>
        <h2 class="transition-title" id="transitionTitle">Module Complete!</h2>
        <p class="transition-message" id="transitionMessage">Great work! Ready for the next challenge?</p>
        <div id="transitionButtons">
          <button class="transition-button" id="transitionButton" onclick="continueToNext()">Continue →</button>
        </div>
      </div>
    </div>
    
    <!-- Module Content Frame -->
    <iframe class="content-frame" id="contentFrame" style="display: none;"></iframe>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
      <div class="loading-spinner"></div>
    </div>
  </div>

  <!-- Reset Confirmation Modal -->
  <div class="reset-modal" id="resetModal">
    <div class="reset-modal-content">
      <div class="reset-modal-icon">⚠️</div>
      <h2 class="reset-modal-title">Reset Training Progress?</h2>
      <p class="reset-modal-message">
        Are you sure you want to reset all training progress? This will clear all completed modules and require re-attestation.
      </p>
      <div class="reset-modal-buttons">
        <button class="reset-modal-button cancel" onclick="closeResetModal()">Cancel</button>
        <button class="reset-modal-button confirm" onclick="confirmReset()">Reset Training</button>
      </div>
    </div>
  </div>

  <script>
    // SCORM API wrapper
    var scorm = {
      version: null, 
      api: null,
      init: function() {
        try {
          this.api = this.getAPI();
          if (this.api) {
            this.version = this.getVersion();
            var result = this.api.LMSInitialize ? this.api.LMSInitialize("") : this.api.Initialize("");
            if (result == "true") {
              this.setValue("cmi.core.lesson_status", "incomplete");
              this.setValue("cmi.core.score.min", "0");
              this.setValue("cmi.core.score.max", "100");
              this.setValue("cmi.core.score.raw", "0");
              this.commit();
              console.log('SCORM initialized successfully');
              return true;
            }
          }
        } catch(e) { 
          console.log("SCORM API not available - standalone mode"); 
        }
        return false;
      },
      getAPI: function() {
        var api = null;
        if (window.parent && window.parent != window) api = this.findAPI(window.parent);
        if (!api && window.opener) api = this.findAPI(window.opener);
        if (!api) api = this.findAPI(window);
        return api;
      },
      findAPI: function(win) {
        var i = 0;
        while (!win.API && !win.API_1484_11 && win.parent && win.parent != win && i < 500) {
          i++;
          win = win.parent;
        }
        return win.API || win.API_1484_11;
      },
      getVersion: function() {
        if (this.api) {
          if (this.api.LMSInitialize) return "1.2";
          if (this.api.Initialize) return "2004";
        }
        return null;
      },
      getValue: function(e) {
        if (!this.api) return "";
        return this.version == "1.2" ? this.api.LMSGetValue(e) : this.api.GetValue(e);
      },
      setValue: function(e, v) {
        if (!this.api) return false;
        return this.version == "1.2" ? this.api.LMSSetValue(e, v) : this.api.SetValue(e, v);
      },
      commit: function() {
        if (!this.api) return false;
        return this.version == "1.2" ? this.api.LMSCommit("") : this.api.Commit("");
      },
      finish: function() {
        if (!this.api) return false;
        return this.version == "1.2" ? this.api.LMSFinish("") : this.api.Terminate("");
      }
    };
    
    // Module configurations
    const modules = {
      phishing: {
        name: 'Phishing, Smishing & Vishing',
        path: 'phishing-smishing-vishing-training/enhanced-interactive-training.html',
        icon: '📧',
        totalSlides: 8,
        currentSlide: 0,
        completed: false,
        choices: { choices: {} }
      },
      ceo: {
        name: 'CEO & Executive Fraud',
        path: 'ceo-executive-fraud-training/enhanced-interactive-training.html',
        icon: '🏢',
        totalSlides: 6,
        currentSlide: 0,
        completed: false,
        choices: { choices: {} }
      },
      watering: {
        name: 'Watering Hole Attacks',
        path: 'watering-hole-attacks-training/enhanced-interactive-training.html',
        icon: '🦁',
        totalSlides: 8,
        currentSlide: 0,
        completed: false,
        choices: { choices: {} }
      },
      general: {
        name: 'General Cybersecurity Awareness',
        path: 'general-cybersecurity-training/enhanced-interactive-training.html',
        icon: '🛡️',
        totalSlides: 10,
        currentSlide: 0,
        completed: false,
        choices: { choices: {} }
      },
      privacy: {
        name: 'Privacy Awareness Training',
        path: 'privacy-awareness-training/enhanced-interactive-training.html',
        icon: '🔐',
        totalSlides: 8,
        currentSlide: 0,
        completed: false,
        choices: { choices: {} }
      },
      'secure-coding': {
        name: 'Secure Coding (OWASP Top 10)',
        path: 'secure-coding-training/enhanced-interactive-training.html',
        icon: '💻',
        totalSlides: 6,
        currentSlide: 0,
        completed: false,
        choices: { choices: {} }
      }
    };
    
    let currentModule = null;
    let nextModule = null;
    
    // Initialize on load
    window.onload = function() {
      scorm.init();
      loadProgress();
      setupMessageListener();
      checkResetFlag();
      updateSCORM();
      
      // Check if attestation has been completed for this version
      const version = getTrainingVersion();
      const attestationComplete = localStorage.getItem(`policyAttestationComplete_${version}`);
      if (attestationComplete === 'true') {
        document.getElementById('policyAttestation').style.display = 'none';
        document.getElementById('homeScreen').style.display = 'flex';
        document.getElementById('sidebar').style.display = 'flex';
        document.querySelector('.sidebar-toggle').style.display = 'flex';
        
        // Check if all modules are complete and show banner if so
        let allComplete = true;
        Object.keys(modules).forEach(key => {
          if (!modules[key].completed) {
            allComplete = false;
          }
        });
        
        if (allComplete) {
          document.getElementById('completionBanner').style.display = 'block';
        }
      } else {
        // Hide sidebar until attestation is complete
        document.getElementById('sidebar').style.display = 'none';
        document.querySelector('.sidebar-toggle').style.display = 'none';
      }
    };
    
    // Toggle attestation button based on checkbox
    function toggleAttestButton() {
      const checkbox = document.getElementById('policyCheckbox');
      const button = document.getElementById('attestButton');
      button.disabled = !checkbox.checked;
      
      if (checkbox.checked) {
        button.textContent = 'I Acknowledge & Begin Training →';
      } else {
        button.textContent = '☑️ Check the box above to continue →';
      }
    }
    
    // Complete attestation and show home screen
    function completeAttestation() {
      document.getElementById('policyAttestation').style.display = 'none';
      document.getElementById('homeScreen').style.display = 'flex';
      // Show sidebar after attestation
      document.getElementById('sidebar').style.display = 'flex';
      document.querySelector('.sidebar-toggle').style.display = 'flex';
      // Mark attestation complete in localStorage for this version
      const version = getTrainingVersion();
      localStorage.setItem(`policyAttestationComplete_${version}`, 'true');
    }
    
    // Check for reset flag
    function checkResetFlag() {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.get('reset') === 'true') {
        resetProgress();
        window.history.replaceState({}, document.title, window.location.pathname);
      }
    }
    
    // Reset progress
    function resetProgress() {
      // Clear all localStorage for this training
      const keysToRemove = [];
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key && (key.includes('cybersecurityPrivacyProgress_') || key.includes('policyAttestationComplete_'))) {
          keysToRemove.push(key);
        }
      }
      keysToRemove.forEach(key => localStorage.removeItem(key));

      // Reload the page to start fresh (same as monthly auto-reset)
      window.location.reload();
    }
    
    // Get training version/campaign ID from URL or generate one
    function getTrainingVersion() {
      const urlParams = new URLSearchParams(window.location.search);
      const campaignId = urlParams.get('campaign') || urlParams.get('version') || urlParams.get('assignment');

      // If we have a campaign ID, use it
      if (campaignId) {
        console.log(`📌 Version: ${campaignId} (from URL parameter)`);
        return campaignId;
      }

      // Use year-month to auto-reset monthly for both SCORM and standalone
      const now = new Date();
      const version = `${now.getFullYear()}-${String(now.getMonth() + 1).padStart(2, '0')}`;
      const mode = scorm.api ? 'SCORM' : 'standalone';
      console.log(`📌 Version: ${version} (${mode} auto-version by month)`);
      return version;
    }
    
    // Load saved progress
    function loadProgress() {
      const version = getTrainingVersion();
      const storageKey = `cybersecurityPrivacyProgress_${version}`;
      
      console.log(`📂 Loading from key: ${storageKey}`);
      const saved = localStorage.getItem(storageKey);
      if (saved) {
        console.log('✅ Found saved progress:', saved.substring(0, 100) + '...');
        const progress = JSON.parse(saved);
        Object.keys(progress).forEach(key => {
          if (modules[key]) {
            modules[key].currentSlide = progress[key].currentSlide || 0;
            modules[key].completed = progress[key].completed || false;
            modules[key].choices = progress[key].choices || { choices: {} };
          }
        });
      } else {
        console.log('🆕 No saved progress found - starting fresh');
      }
      updateSidebar();
    }
    
    // Save progress
    function saveProgress() {
      const version = getTrainingVersion();
      const storageKey = `cybersecurityPrivacyProgress_${version}`;
      localStorage.setItem(storageKey, JSON.stringify(modules));
      console.log(`💾 Saved progress to key: ${storageKey}`);
    }
    
    // Setup message listener for iframe communication
    function setupMessageListener() {
      window.addEventListener('message', function(event) {
        if (event.data.type === 'goHome') {
          // Handle whale logo click to go home
          goHome();
        } else if (event.data.type === 'slideChange') {
          if (currentModule && modules[currentModule]) {
            modules[currentModule].currentSlide = event.data.slide;
            saveProgress();
            updateSidebar();
            updateSCORM();
          }
        } else if (event.data.type === 'moduleComplete') {
          if (currentModule && modules[currentModule]) {
            // Mark as completed but allow re-entry
            if (!modules[currentModule].completed) {
              modules[currentModule].completed = true;
              modules[currentModule].currentSlide = modules[currentModule].totalSlides;
              saveProgress();
              updateSidebar();
              updateSCORM();
              checkOverallCompletion();
              showTransition();
            } else {
              // If already completed and user is reviewing, just show transition
              showTransition();
            }
          }
        } else if (event.data.type === 'choiceUpdate') {
          // Store choice for the current module
          if (currentModule && modules[currentModule] && event.data.slideId && event.data.choice !== undefined) {
            if (event.data.choicesData) {
              modules[currentModule].choices = event.data.choicesData;
            } else {
              // Fallback - ensure structure exists
              if (!modules[currentModule].choices.choices) {
                modules[currentModule].choices = { choices: {} };
              }
              modules[currentModule].choices.choices[event.data.slideId] = event.data.choice;
            }
            saveProgress();
          }
        }
      });
    }
    
    // Go to home screen
    function goHome() {
      currentModule = null;
      document.getElementById('homeScreen').style.display = 'flex';
      document.getElementById('contentFrame').style.display = 'none';
      document.getElementById('transitionScreen').classList.remove('show');

      // Clear active state
      document.querySelectorAll('.module-item').forEach(item => {
        item.classList.remove('active');
      });

      // Show completion banner if all modules are complete
      let allComplete = true;
      Object.keys(modules).forEach(key => {
        if (!modules[key].completed) {
          allComplete = false;
        }
      });

      if (allComplete) {
        document.getElementById('completionBanner').style.display = 'block';
      }
    }

    // Load a module
    function loadModule(moduleId) {
      const module = modules[moduleId];
      if (!module) return;
      
      currentModule = moduleId;
      
      // Show loading overlay
      document.getElementById('loadingOverlay').classList.add('show');
      
      // Update UI
      document.getElementById('homeScreen').style.display = 'none';
      document.getElementById('contentFrame').style.display = 'block';
      document.getElementById('transitionScreen').classList.remove('show');
      
      // Load module content with query param to disable its SCORM
      const frame = document.getElementById('contentFrame');
      
      // Hide loading overlay when iframe loads
      frame.onload = function() {
        setTimeout(() => {
          document.getElementById('loadingOverlay').classList.remove('show');
          
          // Send restore state message to the iframe after it loads
          if (module.choices && Object.keys(module.choices).length > 0) {
            frame.contentWindow.postMessage({
              type: 'restoreState',
              module: moduleId,
              choices: module.choices.choices || module.choices,
              slide: module.currentSlide || 1
            }, '*');
          }
        }, 300);
      };
      
      let modulePath = module.path + '?scorm=disabled';
      
      // For completed modules, start from slide 1 to allow review
      // For in-progress modules, resume where they left off
      if (!module.completed && module.currentSlide > 1) {
        modulePath += '&slide=' + module.currentSlide;
      } else if (module.completed) {
        // Start from slide 1 for review, but keep choices
        modulePath += '&slide=1&reviewMode=true';
      }
      
      // Always pass choices so users can see their previous responses
      if (module.choices && Object.keys(module.choices).length > 0) {
        modulePath += '&choices=' + encodeURIComponent(JSON.stringify(module.choices));
      }
      
      frame.src = modulePath;
      updateSCORM();
      
      // Update sidebar
      document.querySelectorAll('.module-item').forEach(item => {
        item.classList.remove('active');
      });
      document.getElementById(`module-${moduleId}`).classList.add('active');
      
      updateSidebar();
    }
    
    // Show transition screen
    function showTransition() {
      const moduleOrder = ['phishing', 'ceo', 'watering', 'general', 'privacy', 'secure-coding'];
      const currentIndex = moduleOrder.indexOf(currentModule);
      const isReviewing = modules[currentModule] && modules[currentModule].completed;
      
      // Check if all modules are complete
      let allComplete = true;
      Object.keys(modules).forEach(key => {
        if (!modules[key].completed) {
          allComplete = false;
        }
      });
      
      // Reset button container to single button first
      const buttonContainer = document.getElementById('transitionButtons');
      buttonContainer.innerHTML = '<button class="transition-button" id="transitionButton" onclick="continueToNext()">Continue →</button>';
      
      if (allComplete) {
        // All modules complete
        nextModule = null;
        document.getElementById('transitionIcon').textContent = '🏆';
        document.getElementById('transitionTitle').textContent = isReviewing ? 'Review Complete!' : 'Training Complete!';
        document.getElementById('transitionMessage').textContent = isReviewing ? 
          'Thanks for reviewing! Feel free to review other modules or exit the training.' :
          'Congratulations! You\'ve completed all Cybersecurity & Privacy modules!';
        document.getElementById('transitionButton').textContent = 'Return to Home';
      } else if (currentIndex < moduleOrder.length - 1 && !isReviewing) {
        // More modules in order (only show next module if not reviewing)
        nextModule = moduleOrder[currentIndex + 1];
        document.getElementById('transitionIcon').textContent = '🎉';
        document.getElementById('transitionTitle').textContent = 'Module Complete!';
        document.getElementById('transitionMessage').textContent = `Great work on ${modules[currentModule].name}! Ready for ${modules[nextModule].name}?`;
        document.getElementById('transitionButton').textContent = 'Start Next Module →';
      } else {
        // Reviewing or last module but others not complete
        // Check if there are more modules to review
        const incompleteModules = moduleOrder.filter(m => !modules[m].completed);
        if (isReviewing && incompleteModules.length > 0) {
          // Find next incomplete module for review
          nextModule = incompleteModules[0];
          document.getElementById('transitionIcon').textContent = '📚';
          document.getElementById('transitionTitle').textContent = 'Review Complete!';
          document.getElementById('transitionMessage').textContent = `Thanks for reviewing ${modules[currentModule].name}!`;
          
          // Replace with two buttons for review mode
          buttonContainer.innerHTML = `
            <button class="transition-button secondary" onclick="goHome();">
              Return to Home
            </button>
            <button class="transition-button" onclick="loadModule('${nextModule}');">
              Continue to Next Module →
            </button>
          `;
        } else {
          nextModule = null;
          document.getElementById('transitionIcon').textContent = isReviewing ? '📚' : '✅';
          document.getElementById('transitionTitle').textContent = isReviewing ? 'Review Complete!' : 'Module Complete!';
          document.getElementById('transitionMessage').textContent = isReviewing ?
            `Thanks for reviewing ${modules[currentModule].name}!` :
            `Great work on ${modules[currentModule].name}! Check out the other modules to complete your training.`;
          document.getElementById('transitionButton').textContent = 'Return to Home';
        }
      }
      
      document.getElementById('transitionScreen').classList.add('show');
    }
    
    // Continue to next module
    function continueToNext() {
      if (nextModule) {
        loadModule(nextModule);
      } else {
        goHome();
      }
    }
    
    // Update sidebar progress
    function updateSidebar() {
      Object.keys(modules).forEach(key => {
        const module = modules[key];
        const progress = (module.currentSlide / module.totalSlides) * 100;
        
        // Update progress bar
        document.getElementById(`progress-${key}`).style.width = `${progress}%`;
        document.getElementById(`progress-text-${key}`).textContent = 
          `${module.currentSlide}/${module.totalSlides} slides completed`;
        
        // Update status indicator
        const status = document.getElementById(`status-${key}`);
        status.className = 'module-status';
        status.textContent = ''; // Clear any text
        
        if (module.completed) {
          status.classList.add('completed');
          document.getElementById(`module-${key}`).classList.add('completed');
        } else if (module.currentSlide > 0) {
          status.classList.add('in-progress');
          // Don't set any text content - CSS will handle the bullet
        }
      });
    }
    
    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
      // Ctrl+Shift+R to reset
      if (e.ctrlKey && e.shiftKey && e.key === 'R') {
        e.preventDefault();
        if (confirm('Reset all training progress?')) {
          resetProgress();
          goHome();
        }
      }
      // Escape to go home
      else if (e.key === 'Escape') {
        goHome();
      }
    });
    
    // SCORM tracking functions
    function updateSCORM() {
      if (!scorm.api) return;
      
      // Calculate overall progress
      let totalSlides = 0;
      let completedSlides = 0;
      let completedModules = 0;
      
      Object.keys(modules).forEach(key => {
        const module = modules[key];
        totalSlides += module.totalSlides;
        completedSlides += module.currentSlide;
        if (module.completed) completedModules++;
      });
      
      const overallProgress = Math.round((completedSlides / totalSlides) * 100);
      const overallScore = Math.round((completedModules / 6) * 100);
      
      // Update SCORM data
      scorm.setValue('cmi.core.score.raw', String(overallScore));
      scorm.setValue('cmi.core.lesson_location', currentModule || 'home');
      scorm.setValue('cmi.suspend_data', JSON.stringify(modules));
      
      // Update lesson status
      if (completedModules === 6) {
        scorm.setValue('cmi.core.lesson_status', 'completed');
      } else if (completedSlides > 0) {
        scorm.setValue('cmi.core.lesson_status', 'incomplete');
      }
      
      scorm.commit();
    }
    
    function checkOverallCompletion() {
      let allComplete = true;
      Object.keys(modules).forEach(key => {
        if (!modules[key].completed) {
          allComplete = false;
        }
      });
      
      if (allComplete) {
        scorm.setValue('cmi.core.lesson_status', 'passed');
        scorm.setValue('cmi.core.score.raw', '100');
        scorm.commit();
        showCompletionScreen();
      }
    }
    
    // Handle window close
    window.onbeforeunload = function() {
      if (scorm.api) {
        scorm.setValue('cmi.core.exit', '');
        scorm.commit();
        scorm.finish();
      }
    };
    
    // Toggle sidebar function
    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      const toggle = document.querySelector('.sidebar-toggle');
      sidebar.classList.toggle('collapsed');
      toggle.classList.toggle('collapsed');
    }
    
    // Toggle instructions dropdown
    function toggleInstructions() {
      const content = document.getElementById('instructionsContent');
      const arrow = document.getElementById('instructionArrow');
      
      if (content.style.maxHeight === '0px' || !content.style.maxHeight) {
        content.style.maxHeight = content.scrollHeight + 'px';
        arrow.style.transform = 'rotate(180deg)';
      } else {
        content.style.maxHeight = '0';
        arrow.style.transform = 'rotate(0)';
      }
    }
    
    // Show overall completion screen
    function exitTraining() {
      // Complete SCORM session and exit
      if (scorm.api) {
        scorm.setValue('cmi.core.exit', '');
        scorm.commit();
        scorm.finish();
      }
      // LMS will handle the exit, no need to show additional screen
    }
    
    function showFeedbackForm() {
      const feedbackHTML = `
        <div id="feedbackOverlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 2000;">
          <div style="background: white; border-radius: 16px; width: 90%; max-width: 600px; padding: 40px; text-align: center; box-shadow: 0 20px 60px rgba(0,0,0,0.3);">
            <div style="font-size: 64px; margin-bottom: 20px;">📝</div>
            <h2 style="color: var(--primary-purple); margin-bottom: 16px;">Feedback Form</h2>
            <p style="color: #666; font-size: 16px; margin-bottom: 24px; line-height: 1.6;">
              Replace this with your own feedback form URL or survey tool.<br>
              You can embed a Google Form, Typeform, or any other feedback solution.
            </p>
            <p style="background: #f5f5f5; padding: 16px; border-radius: 8px; font-family: monospace; font-size: 14px; color: #333; margin-bottom: 24px; text-align: left;">
              Edit line 1550 in<br>
              <strong>cybersecurity-privacy-training-combined.html</strong><br>
              to add your feedback form iframe or link.
            </p>
            <button onclick="closeFeedbackForm()" style="background: var(--primary-purple); color: white; border: none; padding: 12px 32px; border-radius: 8px; font-size: 16px; cursor: pointer; font-weight: 600;">
              Close
            </button>
          </div>
        </div>
      `;
      document.body.insertAdjacentHTML('beforeend', feedbackHTML);
    }
    
    function closeFeedbackForm() {
      const overlay = document.getElementById('feedbackOverlay');
      if (overlay) overlay.remove();
    }
    
    function closeCompletionScreen() {
      const screen = document.getElementById('finalCompletionScreen');
      if (screen) screen.remove();
      goHome();
      // Banner will show automatically via goHome()
    }

    function showCompletionScreen() {
      const completionHTML = `
        <div id="finalCompletionScreen" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center; background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%); overflow-y: auto; z-index: 1000;">
          <button onclick="closeCompletionScreen()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,255,255,0.2); border: 2px solid white; color: white; font-size: 24px; width: 40px; height: 40px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: all 0.3s ease;">✕</button>
          <div style="text-align: center; max-width: 600px; padding: 40px 20px;">
            <div style="font-size: 120px; margin-bottom: 40px; animation: bounce 2s ease-in-out infinite;">🏆</div>
            <h1 style="font-size: 48px; margin-bottom: 20px; color: white; font-weight: 700;">Congratulations!</h1>
            <h2 style="font-size: 28px; margin-bottom: 60px; opacity: 0.95; color: white;">You've Completed All Cybersecurity & Privacy Modules!</h2>
            
            <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
              <button class="transition-button" onclick="closeCompletionScreen()" style="font-size: 18px; padding: 18px 36px; background: white; color: var(--success-green); border: 2px solid var(--success-green); width: 250px;">Review Modules</button>
              <button class="transition-button" onclick="exitTraining()" style="font-size: 18px; padding: 18px 36px; background: white; color: #6c757d; border: 2px solid #6c757d; width: 250px;">Complete and Exit Training</button>
              <button class="transition-button" onclick="showFeedbackForm()" style="font-size: 18px; padding: 18px 36px; background: white; color: var(--primary-purple); border: 2px solid var(--primary-purple); width: 250px;">Provide Feedback</button>
            </div>
          </div>
        </div>
      `;
      
      // Remove any existing screens
      const existing = document.getElementById('finalCompletionScreen');
      if (existing) existing.remove();
      
      // Add the completion screen
      const mainContent = document.querySelector('.main-content');
      const div = document.createElement('div');
      div.innerHTML = completionHTML;
      mainContent.appendChild(div.firstElementChild);
    }
    
    // Reset modal functions
    function showResetModal() {
      const modal = document.getElementById('resetModal');
      const content = document.querySelector('.reset-modal-content');

      modal.classList.add('show');

      // Trigger animation after a small delay
      setTimeout(() => {
        modal.classList.add('animate-in');
        content.classList.add('animate-in');
      }, 10);
    }

    function closeResetModal() {
      const modal = document.getElementById('resetModal');
      const content = document.querySelector('.reset-modal-content');

      // Animate out
      modal.classList.remove('animate-in');
      content.classList.remove('animate-in');

      // Remove show class after animation completes
      setTimeout(() => {
        modal.classList.remove('show');
      }, 300);
    }

    function confirmReset() {
      closeResetModal();
      setTimeout(() => {
        resetProgress();
      }, 300);
    }

    // Console helper
    console.log('%c GRC Engineering Cybersecurity & Privacy Training', 'color: #7B2CBF; font-size: 20px; font-weight: bold;');
    console.log('Reset progress: window.resetTraining()');
    window.resetTraining = function() {
      resetProgress();
      console.log('✅ Training progress reset');
    };
  </script>
</body>
</html>